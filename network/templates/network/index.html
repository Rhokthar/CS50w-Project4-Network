{% extends "network/layout.html" %}
{% load static %}

{% block script %}
<script src="{% static 'network/js/index.js' %}"></script>
{% endblock %}

{% block body %}
    <!-- POST PAGE CONTENT STARTS -->
    <div id="posts-page" class="page-wrapper">
        <h1>All Posts</h1>

        <!-- NEW POST STARTS -->
        <div class="new-post-container width-100 flex-container vertical-row">
            <h3>New Post</h3>
            <form action="{% url 'new-post' %}" method="post">
                {% csrf_token %}
                <div class="flex-container vertical-row">
                    <textarea id="new-post-text" name="new-post-text" placeholder="Write a new post..." autofocus></textarea>
                    <input type="submit" value="New Post" class="button" />
                </div>
            </form>
        </div>
        <!-- NEW POST ENDS -->

        <!-- ALL POSTS VISUALIZATION STARTS -->
        <div id="posts-container" class="flex-container vertical-row width-100">
            {% for post in page.object_list %}
            <div id="post-{{ post.id }}">
                <h4><a href="profile/{{post.user.username}}">{{ post.user.username }}</a></h4>
                <p class="post-content">{{ post.post_content }}</p>
                <textarea class="edit-post-text" name="edit-post-text">{{ post.post_content }}</textarea>
                <span>{{ post.creation_date }}</span>
                <span class="likes">Likes: {{ post.likes }}</span>
                {% if post.user.username == user.username %}
                    <button class="edit-btn" value="{{ post.id }}">Edit</button>
                    <button class="save-edit-btn" value="{{ post.id }}">Save</button>
                {% endif %}
                <button class="like-btn" value="{{ post.id }}">{% if post in user_liked_posts %}Unlike{% else %}Like{% endif %}</button>
            </div>
            {% endfor %}

            <!-- POSTS PAGES LINKS STARTS -->
            <div class="posts-pages">
                <nav aria-label="Page navigation example">
                    <ul class="pagination">
                        {% if page.has_previous %}
                        <li class="page-item"><a class="page-link" href="{% url 'index' %}?page={{ page.previous_page_number }}">Previous</a></li>
                        <li class="page-item"><a class="page-link" href="{% url 'index' %}?page={{ page.previous_page_number }}">{{ page.previous_page_number }}</a></li>
                        {% endif %}
                        <li class="page-item active"><a class="page-link" href="{% url 'index' %}?page={{ page.number }}">{{ page.number }}</a></li>
                
                        {% if page.has_next %}
                        <li class="page-item"><a class="page-link" href="{% url 'index' %}?page={{ page.next_page_number }}">{{ page.next_page_number }}</a></li>
                        <li class="page-item"><a class="page-link" href="{% url 'index' %}?page={{ page.next_page_number }}">Next</a></li>
                        {% endif %}
                    </ul>
                </nav>
            </div> <!-- POSTS PAGES LINKS ENDS -->
        </div> <!-- ALL POSTS VISUALIZATION ENDS -->
    </div> <!-- POST PAGE CONTENT ENDS -->
{% endblock %}